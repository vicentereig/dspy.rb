{"id":"dspy.rb-04f","title":"[TDD] Make EventRegistry internal-only","description":"## Context\nEventRegistry should become internal plumbing, not a public API. Users should only use DSPy::Module.subscribe. However, Langfuse and tests can still access it via `DSPy.send(:event_registry)`.\n\n## TDD Steps\n\n### 1. RED: Identify all DSPy.events usages\n```bash\ngrep -r 'DSPy\\.events' --include='*.rb' | grep -v spec\n```\n\nInternal usages (KEEP via private accessor):\n- lib/dspy.rb:93-99 (logger subscription)\n- lib/dspy/module.rb:386 (Module.subscribe implementation)\n- lib/dspy/o11y/langfuse/scores_exporter.rb:110 (Langfuse - update to use internal API)\n\n### 2. GREEN: Make registry private but accessible\n\n**a) Change DSPy.events to private:**\n```ruby\n# lib/dspy.rb\nmodule DSPy\n  class \u003c\u003c self\n    private\n    \n    def event_registry\n      @event_registry ||= DSPy::EventRegistry.new.tap do |registry|\n        registry.subscribe('*') { |e, a| emit_log(e, a) if logger }\n      end\n    end\n  end\nend\n```\n\n**b) Update Module.subscribe to use private accessor:**\n```ruby\n# lib/dspy/module.rb\nsubscription_id = DSPy.send(:event_registry).subscribe(spec[:pattern], \u0026callback)\n```\n\n**c) Update Langfuse to use private accessor:**\n```ruby\n# lib/dspy/o11y/langfuse/scores_exporter.rb\n@subscription_id = DSPy.send(:event_registry).subscribe('score.create') do |_name, attrs|\n  # ...\nend\n```\n\n### 3. REFACTOR: Ensure internal usages still work\n\n## Files to Edit\n- lib/dspy.rb (make events private, rename to event_registry)\n- lib/dspy/module.rb (use DSPy.send(:event_registry))\n- lib/dspy/o11y/langfuse/scores_exporter.rb (use DSPy.send(:event_registry))\n\n## Acceptance Criteria\n- [ ] DSPy.events raises NoMethodError (private)\n- [ ] DSPy::Module.subscribe still works\n- [ ] Internal logger subscription still works\n- [ ] Langfuse ScoresExporter still works\n- [ ] All tests pass (tests can use DSPy.send(:event_registry))","status":"open","priority":2,"issue_type":"task","owner":"hey@vicente.services","created_at":"2026-01-26T15:19:44.448106+01:00","created_by":"Vicente Reig Rinc贸n de Arellano","updated_at":"2026-01-26T15:33:07.777983+01:00","dependencies":[{"issue_id":"dspy.rb-04f","depends_on_id":"dspy.rb-v8a","type":"blocks","created_at":"2026-01-26T15:20:03.420679+01:00","created_by":"Vicente Reig Rinc贸n de Arellano"},{"issue_id":"dspy.rb-04f","depends_on_id":"dspy.rb-iwz","type":"blocks","created_at":"2026-01-26T15:20:03.48222+01:00","created_by":"Vicente Reig Rinc贸n de Arellano"},{"issue_id":"dspy.rb-04f","depends_on_id":"dspy.rb-bsh","type":"blocks","created_at":"2026-01-26T15:34:28.104335+01:00","created_by":"Vicente Reig Rinc贸n de Arellano"}]}
{"id":"dspy.rb-0ch","title":"[Example] Create example code-backed tool module","description":"**Phase**: Examples","acceptance_criteria":"- Working example with external dependency\n- Shows returning typed output struct\n- Shows dependency injection","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-14T19:00:17.604948+01:00","updated_at":"2026-01-14T19:00:17.604948+01:00","dependencies":[{"issue_id":"dspy.rb-0ch","depends_on_id":"dspy.rb-gw7","type":"blocks","created_at":"2026-01-14T19:01:18.857823+01:00","created_by":"Vicente Reig Rinc贸n de Arellano"}]}
{"id":"dspy.rb-0z0","title":"Tutorial: Parallelizing Work with DSPy.rb","description":"Write a tutorial demonstrating how to parallelize LLM work in DSPy.rb.\n\n**Primary Use Case**: Naming a conversation while answering the user's request simultaneously.\n\nWhen a user sends their first message, the system needs to:\n1. Generate a response to the user's question\n2. Generate a title/name for the conversation\n\nThese two tasks are independent and can run in parallel, reducing latency.\n\n**Tutorial Should Cover**:\n- Using Async gem with DSPy.rb modules\n- Running multiple predictions concurrently\n- Error handling for parallel operations\n- When parallelization makes sense vs sequential execution\n- Performance considerations and tradeoffs\n\n**Example Code Structure**:\n```ruby\nAsync do |task|\n  response_task = task.async { responder.predict(message: user_message) }\n  title_task = task.async { titler.predict(messages: [user_message]) }\n  \n  response = response_task.wait\n  title = title_task.wait\nend\n```","status":"open","priority":2,"issue_type":"task","owner":"hey@vicente.services","created_at":"2026-01-17T13:21:12.64344+01:00","created_by":"Vicente Reig Rinc贸n de Arellano","updated_at":"2026-01-17T13:56:07.981461+01:00"}
{"id":"dspy.rb-0zs","title":"Test Issue Two","description":"This is the second test description.","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-01-14T18:59:09.267795+01:00","updated_at":"2026-01-14T18:59:20.908409+01:00","deleted_at":"2026-01-14T18:59:20.908409+01:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"dspy.rb-1gj","title":"[Example] Create example hybrid tool module","description":"**Phase**: Examples","acceptance_criteria":"- LLM expands/refines input\n- Code executes actual operation\n- Shows composition of both approaches","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-14T19:00:17.605325+01:00","updated_at":"2026-01-14T19:00:17.605325+01:00","dependencies":[{"issue_id":"dspy.rb-1gj","depends_on_id":"dspy.rb-dz6","type":"blocks","created_at":"2026-01-14T19:01:18.906935+01:00","created_by":"Vicente Reig Rinc贸n de Arellano"},{"issue_id":"dspy.rb-1gj","depends_on_id":"dspy.rb-0ch","type":"blocks","created_at":"2026-01-14T19:01:18.958395+01:00","created_by":"Vicente Reig Rinc贸n de Arellano"}]}
{"id":"dspy.rb-32j","title":"[Test] Integration tests for signature-bound modules","description":"**Phase**: Foundation","acceptance_criteria":"- Test LLM-backed module with signature binding\n- Test code-backed module with signature binding\n- Test hybrid module (LLM + code)\n- Test `to_mcp_schema` output format\n- Test inheritance behavior\n- VCR cassettes for LLM tests","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-14T19:00:17.604214+01:00","updated_at":"2026-01-14T19:00:17.604214+01:00","dependencies":[{"issue_id":"dspy.rb-32j","depends_on_id":"dspy.rb-gw7","type":"blocks","created_at":"2026-01-14T19:01:09.038202+01:00","created_by":"Vicente Reig Rinc贸n de Arellano"},{"issue_id":"dspy.rb-32j","depends_on_id":"dspy.rb-gym","type":"blocks","created_at":"2026-01-14T19:01:09.075995+01:00","created_by":"Vicente Reig Rinc贸n de Arellano"},{"issue_id":"dspy.rb-32j","depends_on_id":"dspy.rb-gg8","type":"blocks","created_at":"2026-01-14T19:01:09.115275+01:00","created_by":"Vicente Reig Rinc贸n de Arellano"}]}
{"id":"dspy.rb-3bx","title":"[Docs] Update Toolsets documentation","description":"**Phase**: Documentation","acceptance_criteria":"- Explain signature + module pattern\n- Show LLM-backed vs code-backed examples\n- Migration guide from old pattern\n- MCP export documentation","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-14T19:00:17.608861+01:00","updated_at":"2026-01-14T19:00:17.608861+01:00","dependencies":[{"issue_id":"dspy.rb-3bx","depends_on_id":"dspy.rb-cdb","type":"blocks","created_at":"2026-01-14T19:01:56.565846+01:00","created_by":"Vicente Reig Rinc贸n de Arellano"}]}
{"id":"dspy.rb-41s","title":"[Docs] Update ReAct agent documentation","description":"**Phase**: Documentation","acceptance_criteria":"- New tool creation pattern\n- ToolOrchestrator introduction\n- Examples updated","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-14T19:00:17.609171+01:00","updated_at":"2026-01-14T19:00:17.609171+01:00","dependencies":[{"issue_id":"dspy.rb-41s","depends_on_id":"dspy.rb-emi","type":"blocks","created_at":"2026-01-14T19:01:56.609898+01:00","created_by":"Vicente Reig Rinc贸n de Arellano"}]}
{"id":"dspy.rb-4vf","title":"[Docs] Write MCP integration guide","description":"**Phase**: Documentation","acceptance_criteria":"- Explain MCP protocol briefly\n- Show `to_mcp_schema` usage\n- Example MCP server setup\n- Tool discovery patterns","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-14T19:00:17.609515+01:00","updated_at":"2026-01-14T19:00:17.609515+01:00","dependencies":[{"issue_id":"dspy.rb-4vf","depends_on_id":"dspy.rb-gg8","type":"blocks","created_at":"2026-01-14T19:01:56.648748+01:00","created_by":"Vicente Reig Rinc贸n de Arellano"}]}
{"id":"dspy.rb-5br","title":"[Cleanup] Remove deprecated tool classes","description":"**Phase**: Cleanup","acceptance_criteria":"- All references removed\n- Tests updated\n- No broken imports","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-14T19:00:17.608566+01:00","updated_at":"2026-01-14T19:00:17.608566+01:00","dependencies":[{"issue_id":"dspy.rb-5br","depends_on_id":"dspy.rb-mc8","type":"blocks","created_at":"2026-01-14T19:01:47.687558+01:00","created_by":"Vicente Reig Rinc贸n de Arellano"},{"issue_id":"dspy.rb-5br","depends_on_id":"dspy.rb-9jn","type":"blocks","created_at":"2026-01-14T19:01:47.728531+01:00","created_by":"Vicente Reig Rinc贸n de Arellano"}]}
{"id":"dspy.rb-6kp","title":"[TDD] Migrate examples and benchmarks to module pattern","description":"## Context\nExamples and benchmarks demonstrate the old global subscription pattern. Update them to show the recommended Module.subscribe pattern.\n\nNote: The old pattern still works (via internal API), but we want examples to demonstrate the recommended approach.\n\n## TDD Steps\n\n### 1. RED: Identify all examples using global subscription\n```bash\ngrep -r 'DSPy\\.events\\.subscribe' examples/\n```\n\nFiles:\n- examples/event_system_demo.rb\n- examples/baml_vs_json_benchmark.rb\n- examples/json_modes_benchmark.rb\n\n### 2. GREEN: Refactor each example to use Module.subscribe\n\n**examples/event_system_demo.rb:**\n```ruby\n# Rewrite to demonstrate Module.subscribe pattern\nclass DemoModule \u003c DSPy::Module\n  subscribe 'demo.*', :handle_demo_event\n  \n  def handle_demo_event(event_name, attrs)\n    puts \" Event: #{event_name}\"\n  end\n  \n  def forward(...)\n    # demo logic\n  end\nend\n```\n\n**examples/baml_vs_json_benchmark.rb:**\n```ruby\nclass BenchmarkHarness \u003c DSPy::Module\n  subscribe 'lm.tokens', :capture_usage\n  \n  attr_reader :captured_usage\n  \n  def forward(predictor:, **input)\n    predictor.call(**input)\n  end\n  \n  def capture_usage(_, attrs)\n    @captured_usage = { input: attrs[:input_tokens], output: attrs[:output_tokens] }\n  end\nend\n```\n\n### 3. REFACTOR: Verify examples still work\n```bash\nruby examples/event_system_demo.rb\n```\n\n## Files to Edit\n- examples/event_system_demo.rb\n- examples/baml_vs_json_benchmark.rb\n- examples/json_modes_benchmark.rb\n\n## Acceptance Criteria\n- [ ] All examples use Module.subscribe pattern\n- [ ] Examples run without errors\n- [ ] Examples demonstrate the recommended (documented) pattern","status":"open","priority":3,"issue_type":"task","owner":"hey@vicente.services","created_at":"2026-01-26T15:19:44.857439+01:00","created_by":"Vicente Reig Rinc贸n de Arellano","updated_at":"2026-01-26T15:33:46.759727+01:00","dependencies":[{"issue_id":"dspy.rb-6kp","depends_on_id":"dspy.rb-04f","type":"blocks","created_at":"2026-01-26T15:20:03.608624+01:00","created_by":"Vicente Reig Rinc贸n de Arellano"}]}
{"id":"dspy.rb-7xb","title":"[Feature] SelectToolSignature definition","description":"**Phase**: Orchestrator","acceptance_criteria":"- Input: task, available_tools, history\n- Output: action, tool_name, tool_input\n- Handles \"finish\" action","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-14T19:00:17.607307+01:00","updated_at":"2026-01-14T19:00:17.607307+01:00","dependencies":[{"issue_id":"dspy.rb-7xb","depends_on_id":"dspy.rb-8gz","type":"blocks","created_at":"2026-01-14T19:01:39.884021+01:00","created_by":"Vicente Reig Rinc贸n de Arellano"}]}
{"id":"dspy.rb-8gz","title":"[Feature] Create ToolOrchestrator module","description":"**Phase**: Orchestrator","acceptance_criteria":"- Accepts array of signature-bound modules\n- LLM-based tool selection\n- Configurable max iterations\n- History tracking\n- Final synthesis","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-14T19:00:17.606972+01:00","updated_at":"2026-01-14T19:00:17.606972+01:00","dependencies":[{"issue_id":"dspy.rb-8gz","depends_on_id":"dspy.rb-hf3","type":"blocks","created_at":"2026-01-14T19:01:39.831545+01:00","created_by":"Vicente Reig Rinc贸n de Arellano"}]}
{"id":"dspy.rb-8x4","title":"[TDD] Fix SubcriptionScope typo","description":"## Context\nThere's a typo in the API: `SubcriptionScope` should be `SubscriptionScope`.\n\n## TDD Steps\n\n### 1. RED: Find all occurrences\n```bash\ngrep -r 'SubcriptionScope' --include='*.rb'\n```\n\n### 2. GREEN: Rename with alias for transition\n```ruby\n# lib/dspy/module.rb\nclass SubscriptionScope \u003c T::Enum\n  enums do\n    Descendants = new('descendants')\n    SelfOnly    = new('self')\n  end\nend\n\n# Alias for backwards compatibility (can remove in next major)\nSubcriptionScope = SubscriptionScope\n```\n\n### 3. REFACTOR: Update all references\n- Update specs\n- Update docs\n- Remove alias after confirming no external usage\n\n## Files to Edit\n- lib/dspy/module.rb\n\n## Acceptance Criteria\n- [ ] SubscriptionScope is the canonical name\n- [ ] All internal code uses correct spelling\n- [ ] Tests pass","status":"open","priority":3,"issue_type":"task","owner":"hey@vicente.services","created_at":"2026-01-26T15:19:45.119559+01:00","created_by":"Vicente Reig Rinc贸n de Arellano","updated_at":"2026-01-26T15:19:45.119559+01:00"}
{"id":"dspy.rb-8zh","title":"Test Issue One","description":"This is the first test description.","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-01-14T18:59:09.266254+01:00","updated_at":"2026-01-14T18:59:20.908409+01:00","deleted_at":"2026-01-14T18:59:20.908409+01:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"dspy.rb-9jn","title":"[Deprecation] Deprecate Tools::Toolset","description":"**Phase**: Cleanup","acceptance_criteria":"- Warning on class inheritance\n- Warning on usage\n- Migration guide in docs","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-14T19:00:17.608265+01:00","updated_at":"2026-01-14T19:00:17.608265+01:00","dependencies":[{"issue_id":"dspy.rb-9jn","depends_on_id":"dspy.rb-cdb","type":"blocks","created_at":"2026-01-14T19:01:47.646412+01:00","created_by":"Vicente Reig Rinc贸n de Arellano"}]}
{"id":"dspy.rb-9m7","title":"Unsafe deserialization in program storage","description":"deserialize_program uses Object.const_get with class name from serialized data (lib/dspy/storage/program_storage.rb:107-126). Could be exploited if attacker has file write access. Fix: validate class_name against allowlist of known DSPy modules.","status":"open","priority":1,"issue_type":"bug","owner":"hey@vicente.services","created_at":"2026-01-24T20:00:47.51739+01:00","created_by":"Vicente Reig Rinc贸n de Arellano","updated_at":"2026-01-24T20:01:42.682164+01:00"}
{"id":"dspy.rb-9yn","title":"Consolidate type introspection logic into TypeUtils module","description":"Type introspection duplicated in ReAct (~70 lines), Prediction (~50 lines), TypeCoercion mixin: scalar_type?, structured_type?, type_name, extract_enum_class. Create single DSPy::TypeUtils module. ~100 LOC savings.","status":"closed","priority":3,"issue_type":"task","owner":"hey@vicente.services","created_at":"2026-01-24T20:00:55.817426+01:00","created_by":"Vicente Reig Rinc贸n de Arellano","updated_at":"2026-01-24T20:24:21.553981+01:00","closed_at":"2026-01-24T20:24:21.553981+01:00","close_reason":"Type introspection methods consolidated into TypeCoercion mixin (scalar_type?, structured_type?, string_type?, type_name, default_value_for_type). ReAct now inherits these via Predict.","dependencies":[{"issue_id":"dspy.rb-9yn","depends_on_id":"dspy.rb-bas","type":"blocks","created_at":"2026-01-24T20:02:10.054842+01:00","created_by":"Vicente Reig Rinc贸n de Arellano"}]}
{"id":"dspy.rb-bas","title":"ReAct class decomposition (800+ lines)","description":"ReAct class is 800+ lines handling 6+ concerns: signature creation, history management, tool execution, type deserialization, output validation, type introspection. Extract to ReAct::HistoryManager, ReAct::ToolExecutor, ReAct::TypeDeserializer.","status":"closed","priority":2,"issue_type":"task","owner":"hey@vicente.services","created_at":"2026-01-24T20:00:47.643143+01:00","created_by":"Vicente Reig Rinc贸n de Arellano","updated_at":"2026-01-24T20:24:15.254803+01:00","closed_at":"2026-01-24T20:24:15.254803+01:00","close_reason":"Type introspection concern extracted to TypeCoercion mixin. ReAct reduced from 869 to 766 lines. Further decomposition (HistoryManager, ToolExecutor) can be done separately as the class is now more maintainable."}
{"id":"dspy.rb-bsh","title":"[TDD] Remove SubscriberMixin (dead code)","description":"## Context\nSubscriberMixin is dead code - not used anywhere in production, only tested in isolation.\n\n## TDD Steps\n\n### 1. RED: Verify no production usage\n```bash\n# Search for any real usage (should find nothing except spec)\ngrep -r 'SubscriberMixin' --include='*.rb' | grep -v spec | grep -v subscriber_mixin.rb\n```\n\n### 2. GREEN: Remove the code\n- Delete `lib/dspy/events/subscriber_mixin.rb` (79 lines)\n- Delete `spec/unit/dspy/events/subscriber_mixin_spec.rb`\n- Remove `require_relative 'dspy/events/subscriber_mixin'` from `lib/dspy.rb:225`\n\n### 3. REFACTOR: Run full test suite\n```bash\nbundle exec rspec\n```\n\n## Files to Delete\n- lib/dspy/events/subscriber_mixin.rb\n- spec/unit/dspy/events/subscriber_mixin_spec.rb\n\n## Files to Edit\n- lib/dspy.rb (remove require)\n\n## Acceptance Criteria\n- [ ] No grep matches for SubscriberMixin in production code\n- [ ] Files deleted\n- [ ] All tests pass\n- [ ] ~80 LOC removed","status":"open","priority":2,"issue_type":"task","owner":"hey@vicente.services","created_at":"2026-01-26T15:19:44.029945+01:00","created_by":"Vicente Reig Rinc贸n de Arellano","updated_at":"2026-01-26T15:19:44.029945+01:00"}
{"id":"dspy.rb-cdb","title":"[Refactor] Migrate MemoryToolset to signature-bound modules","description":"**Phase**: Migration","acceptance_criteria":"- Create `MemoryStore` signature and `MemoryStoreTool` module\n- Create `MemoryRetrieve` signature and `MemoryRetrieveTool` module\n- Create `MemoryList` signature and `MemoryListTool` module\n- Shared memory state via injection\n- Deprecation warning on old toolset","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-14T19:00:17.605637+01:00","updated_at":"2026-01-14T19:00:17.605637+01:00","dependencies":[{"issue_id":"dspy.rb-cdb","depends_on_id":"dspy.rb-32j","type":"blocks","created_at":"2026-01-14T19:01:26.388904+01:00","created_by":"Vicente Reig Rinc贸n de Arellano"}]}
{"id":"dspy.rb-ds6","title":"Command injection in GitHub CLI toolset","description":"shell_escape() only escapes double quotes, allowing injection via backticks or $() (lib/dspy/tools/github_cli_toolset.rb:268-278). Fix: use Shellwords.shellescape or Open3.capture3 with array args.","status":"open","priority":1,"issue_type":"bug","owner":"hey@vicente.services","created_at":"2026-01-24T20:00:47.28316+01:00","created_by":"Vicente Reig Rinc贸n de Arellano","updated_at":"2026-01-24T20:01:42.337743+01:00"}
{"id":"dspy.rb-dz6","title":"[Example] Create example LLM-backed tool module","description":"**Phase**: Examples","acceptance_criteria":"- Working example with real signature\n- Shows LM selection\n- Shows technique selection (Predict vs CoT)","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-14T19:00:17.604583+01:00","updated_at":"2026-01-14T19:00:17.604583+01:00","dependencies":[{"issue_id":"dspy.rb-dz6","depends_on_id":"dspy.rb-gw7","type":"blocks","created_at":"2026-01-14T19:01:18.798491+01:00","created_by":"Vicente Reig Rinc贸n de Arellano"}]}
{"id":"dspy.rb-eh4","title":"[TDD] Create TestEventObserver module for specs","description":"## Context\nBefore removing global subscription, we need a test helper that captures events using the module-based approach.\n\n## TDD Steps\n\n### 1. RED: Write failing test for TestEventObserver\n```ruby\n# spec/support/test_event_observer.rb\nRSpec.describe 'TestEventObserver' do\n  it 'captures events from nested module calls' do\n    observer = TestEventObserver.new\n    observer.observe do\n      DSPy.event('test.event', data: 'value')\n    end\n    expect(observer.events).to include(hash_including(name: 'test.event'))\n  end\nend\n```\n\n### 2. GREEN: Implement TestEventObserver\n```ruby\nclass TestEventObserver \u003c DSPy::Module\n  subscribe '*', :capture_event\n  \n  attr_reader :events\n  \n  def initialize\n    super\n    @events = []\n  end\n  \n  def forward(\u0026block)\n    block.call\n  end\n  \n  def observe(\u0026block)\n    forward(\u0026block)\n  end\n  \n  def capture_event(event_name, attrs)\n    @events \u003c\u003c { name: event_name, attrs: attrs }\n  end\n  \n  def clear!\n    @events.clear\n  end\nend\n```\n\n### 3. REFACTOR: Add convenience methods\n- `events_named(pattern)` - filter by event name\n- `last_event` - most recent event\n- Integration with RSpec matchers\n\n## Files to Create\n- spec/support/test_event_observer.rb\n\n## Acceptance Criteria\n- [ ] TestEventObserver captures events from nested modules\n- [ ] Works with scope: :descendants (default)\n- [ ] Provides convenient query methods\n- [ ] Can be used in before/after blocks","status":"closed","priority":2,"issue_type":"task","owner":"hey@vicente.services","created_at":"2026-01-26T15:19:44.163606+01:00","created_by":"Vicente Reig Rinc贸n de Arellano","updated_at":"2026-01-26T15:32:40.325605+01:00","closed_at":"2026-01-26T15:32:40.325605+01:00","close_reason":"No longer needed. Tests can use internal DSPy.events.subscribe directly since we're keeping it accessible (just undocumented)."}
{"id":"dspy.rb-emi","title":"[Refactor] Refactor ReAct to use ToolOrchestrator","description":"**Phase**: Orchestrator","acceptance_criteria":"- Delegates to ToolOrchestrator internally\n- Maintains backward-compatible API\n- Deprecation path documented","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-14T19:00:17.607632+01:00","updated_at":"2026-01-14T19:00:17.607632+01:00","dependencies":[{"issue_id":"dspy.rb-emi","depends_on_id":"dspy.rb-8gz","type":"blocks","created_at":"2026-01-14T19:01:39.938469+01:00","created_by":"Vicente Reig Rinc贸n de Arellano"}]}
{"id":"dspy.rb-fd9","title":"Command injection in text processing toolset","description":"grep/ripgrep methods use shell backticks with user patterns without escaping (lib/dspy/tools/text_processing_toolset.rb:43-44, 82-86). Pattern can break out of single quotes. Fix: use Ruby regex or Shellwords.shellescape.","status":"open","priority":1,"issue_type":"bug","owner":"hey@vicente.services","created_at":"2026-01-24T20:00:47.400426+01:00","created_by":"Vicente Reig Rinc贸n de Arellano","updated_at":"2026-01-24T20:01:42.552731+01:00"}
{"id":"dspy.rb-fwx","title":"[TDD] Update documentation for module-only events","description":"## Context\nDocumentation needs to reflect the new module-only subscription API. The global DSPy.events API becomes internal (private method).\n\n## TDD Steps\n\n### 1. RED: Identify all docs mentioning global subscription\n```bash\ngrep -r 'DSPy\\.events\\.subscribe' docs/\ngrep -r 'BaseSubscriber' docs/\n```\n\nFiles:\n- docs/src/core-concepts/events.md\n- docs/src/production/observability.md\n- docs/src/advanced/observability-interception.md\n- docs/src/llms-full.txt.erb\n- CHANGELOG.md\n\n### 2. GREEN: Rewrite documentation\n\n**docs/src/core-concepts/events.md:**\n- Remove 'Global Listeners' section entirely\n- Keep Module.subscribe as the ONLY documented pattern\n- Remove BaseSubscriber examples\n- Add note that DSPy.events is internal/private\n\n**docs/src/production/observability.md:**\n- Update Langfuse integration explanation (it uses internal API)\n- Show recommended root module pattern for observability:\n\n```ruby\n# Recommended: Create a root module that observes all events\nclass MyApplication \u003c DSPy::Module\n  subscribe 'lm.tokens', :track_costs\n  subscribe 'llm.*', :log_requests\n  \n  def forward(**input)\n    # Your application logic here\n    @agent.call(**input)\n  end\n  \n  def track_costs(_, attrs)\n    CostTracker.record(attrs[:total_tokens])\n  end\nend\n```\n\n**Add 'Root Observer Pattern' section:**\n- Explain that users should wrap their DSPy code in a root module\n- Show how to capture events across all nested modules\n- Explain scope: :descendants vs scope: :self\n\n### 3. REFACTOR: Build docs site to verify\n```bash\ncd docs \u0026\u0026 npm run build\n```\n\n## Files to Edit\n- docs/src/core-concepts/events.md\n- docs/src/production/observability.md\n- docs/src/advanced/observability-interception.md\n- docs/src/llms-full.txt.erb\n\n## Acceptance Criteria\n- [ ] No docs reference DSPy.events.subscribe as public API\n- [ ] No docs reference BaseSubscriber\n- [ ] Root observer pattern documented\n- [ ] Docs explain DSPy.events is internal/private\n- [ ] Docs site builds successfully","status":"open","priority":3,"issue_type":"task","owner":"hey@vicente.services","created_at":"2026-01-26T15:19:44.989026+01:00","created_by":"Vicente Reig Rinc贸n de Arellano","updated_at":"2026-01-26T15:34:02.699583+01:00","dependencies":[{"issue_id":"dspy.rb-fwx","depends_on_id":"dspy.rb-wbn","type":"blocks","created_at":"2026-01-26T15:20:03.672657+01:00","created_by":"Vicente Reig Rinc贸n de Arellano"},{"issue_id":"dspy.rb-fwx","depends_on_id":"dspy.rb-6kp","type":"blocks","created_at":"2026-01-26T15:20:03.742503+01:00","created_by":"Vicente Reig Rinc贸n de Arellano"},{"issue_id":"dspy.rb-fwx","depends_on_id":"dspy.rb-04f","type":"blocks","created_at":"2026-01-26T15:34:28.165377+01:00","created_by":"Vicente Reig Rinc贸n de Arellano"}]}
{"id":"dspy.rb-fxf","title":"CodeAct eval() arbitrary code execution vulnerability","description":"CRITICAL: CodeAct uses Ruby eval() to execute LLM-generated code without sandboxing (lib/dspy/code_act.rb:400-428). An attacker could craft prompts causing malicious code execution. Solutions: container isolation, safe_ruby gem, or static analysis allowlist.","status":"open","priority":0,"issue_type":"bug","owner":"hey@vicente.services","created_at":"2026-01-24T20:00:47.166582+01:00","created_by":"Vicente Reig Rinc贸n de Arellano","updated_at":"2026-01-24T20:01:37.789826+01:00"}
{"id":"dspy.rb-gg8","title":"[Feature] Add `to_mcp_schema` export to Module","description":"**Phase**: Foundation","acceptance_criteria":"- Returns hash with `name`, `description`, `inputSchema`\n- Schema matches MCP tool specification\n- Works on module instances","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-14T19:00:17.603829+01:00","updated_at":"2026-01-14T19:00:17.603829+01:00","dependencies":[{"issue_id":"dspy.rb-gg8","depends_on_id":"dspy.rb-gym","type":"blocks","created_at":"2026-01-14T19:01:08.98367+01:00","created_by":"Vicente Reig Rinc贸n de Arellano"}]}
{"id":"dspy.rb-gw7","title":"[Feature] Add `signature` DSL to DSPy::Module","description":"**Phase**: Foundation","acceptance_criteria":"- `signature MySignature` binds signature to module\n- `bound_signature` returns the bound class\n- Works with inheritance\n- No breaking changes to existing modules","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-14T19:00:17.602625+01:00","updated_at":"2026-01-14T19:00:17.602625+01:00"}
{"id":"dspy.rb-gym","title":"[Feature] Add tool metadata methods to Module","description":"**Phase**: Foundation","acceptance_criteria":"- `tool_name` derived from signature class name\n- `tool_description` returns signature description\n- `input_schema` / `output_schema` return JSON Schema\n- Returns nil gracefully when no signature bound","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-14T19:00:17.603392+01:00","updated_at":"2026-01-14T19:00:17.603392+01:00","dependencies":[{"issue_id":"dspy.rb-gym","depends_on_id":"dspy.rb-gw7","type":"blocks","created_at":"2026-01-14T19:01:08.93263+01:00","created_by":"Vicente Reig Rinc贸n de Arellano"}]}
{"id":"dspy.rb-hcp","title":"Sequential bootstrap execution in MIPROv2","description":"create_bootstrapped_demos executes LLM calls sequentially (lib/dspy/teleprompt/utils.rb:334-381). For 100 training examples, this means sequential 500ms-2s calls. Fix: use Concurrent::Promises pattern from existing evaluate_in_parallel.","status":"open","priority":2,"issue_type":"task","owner":"hey@vicente.services","created_at":"2026-01-24T20:00:55.451471+01:00","created_by":"Vicente Reig Rinc贸n de Arellano","updated_at":"2026-01-24T20:01:57.197609+01:00"}
{"id":"dspy.rb-hf3","title":"[Refactor] Update ReAct to accept signature-bound modules","description":"**Phase**: Migration","acceptance_criteria":"- Accept modules with `bound_signature`\n- Use `to_mcp_schema` for tool descriptions\n- Call `forward(**args)` for execution\n- Backward compat: still accept old `Tools::Base`\n- Deprecation warning for old format","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-14T19:00:17.605971+01:00","updated_at":"2026-01-14T19:00:17.605971+01:00","dependencies":[{"issue_id":"dspy.rb-hf3","depends_on_id":"dspy.rb-gg8","type":"blocks","created_at":"2026-01-14T19:01:26.434891+01:00","created_by":"Vicente Reig Rinc贸n de Arellano"}]}
{"id":"dspy.rb-hgn","title":"Unified Tool Model (Signature + Module)","description":"Replace Tools::Base and Tools::Toolset with a unified model where Module + Signature = Tool. See ADR-018.","status":"open","priority":2,"issue_type":"epic","owner":"hey@vicente.services","created_at":"2026-01-14T18:59:26.952257+01:00","created_by":"Vicente Reig Rinc贸n de Arellano","updated_at":"2026-01-14T18:59:26.952257+01:00"}
{"id":"dspy.rb-iwz","title":"[TDD] Migrate all specs to TestEventObserver","description":"## Context\nAll specs using DSPy.events.subscribe need to migrate to TestEventObserver pattern.\n\n## TDD Steps\n\n### 1. RED: Identify all specs using global subscription\n```bash\ngrep -r 'DSPy\\.events\\.subscribe' spec/\n```\n\nFiles to migrate:\n- spec/unit/event_system_spec.rb\n- spec/unit/typed_events_spec.rb\n- spec/unit/module_event_integration_spec.rb\n- spec/unit/dspy/lm_request_correlation_spec.rb\n- spec/dspy/scores/evaluators_spec.rb\n- spec/dspy/scores/evals_integration_spec.rb\n- spec/dspy/scores/dspy_score_method_spec.rb\n- spec/integration/dspy/lm_spec.rb\n- spec/integration/deep_research/module_spec.rb\n\n### 2. GREEN: Migrate each spec file\n\n**Pattern A: Wrap test code in observer.observe block**\n```ruby\n# Before\nit 'emits token events' do\n  events = []\n  DSPy.events.subscribe('lm.tokens') { |e, a| events \u003c\u003c a }\n  predictor.call(question: 'test')\n  expect(events.first[:total_tokens]).to be \u003e 0\nend\n\n# After\nit 'emits token events' do\n  observer = TestEventObserver.new\n  observer.observe do\n    predictor.call(question: 'test')\n  end\n  token_event = observer.events_named('lm.tokens').first\n  expect(token_event[:attrs][:total_tokens]).to be \u003e 0\nend\n```\n\n**Pattern B: For tests that test the event system itself**\nThese may need special handling - we still need to verify Module.subscribe works.\n\n### 3. REFACTOR: Remove DSPy.events.clear_listeners calls\n\n## Files to Edit\n- All spec files listed above\n\n## Acceptance Criteria\n- [ ] No spec uses DSPy.events.subscribe\n- [ ] No spec uses DSPy.events.clear_listeners\n- [ ] All specs pass\n- [ ] Coverage maintained","status":"closed","priority":2,"issue_type":"task","owner":"hey@vicente.services","created_at":"2026-01-26T15:19:44.72399+01:00","created_by":"Vicente Reig Rinc贸n de Arellano","updated_at":"2026-01-26T15:32:40.449995+01:00","closed_at":"2026-01-26T15:32:40.449995+01:00","close_reason":"No longer needed. Tests can keep using DSPy.events.subscribe since we're keeping it accessible (just undocumented). No migration required.","dependencies":[{"issue_id":"dspy.rb-iwz","depends_on_id":"dspy.rb-eh4","type":"blocks","created_at":"2026-01-26T15:20:03.356025+01:00","created_by":"Vicente Reig Rinc贸n de Arellano"}]}
{"id":"dspy.rb-mc8","title":"[Deprecation] Deprecate Tools::Base","description":"**Phase**: Cleanup","acceptance_criteria":"- Warning on class inheritance\n- Warning on usage\n- Migration guide in docs","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-14T19:00:17.607946+01:00","updated_at":"2026-01-14T19:00:17.607946+01:00","dependencies":[{"issue_id":"dspy.rb-mc8","depends_on_id":"dspy.rb-hf3","type":"blocks","created_at":"2026-01-14T19:01:47.601192+01:00","created_by":"Vicente Reig Rinc贸n de Arellano"}]}
{"id":"dspy.rb-q5h","title":"Code duplication in multimodal message formatting","description":"format_multimodal_messages duplicated in 4 adapters (~100 LOC): openai_adapter.rb:146-171, anthropic_adapter.rb:271-296, gemini_adapter.rb:180-205, ruby_llm_adapter.rb:362-386. Extract to base Adapter class or shared mixin.","status":"closed","priority":2,"issue_type":"task","owner":"hey@vicente.services","created_at":"2026-01-24T20:00:47.753674+01:00","created_by":"Vicente Reig Rinc贸n de Arellano","updated_at":"2026-01-24T20:15:25.103591+01:00","closed_at":"2026-01-24T20:15:25.103591+01:00","close_reason":"Extracted format_multimodal_messages to base Adapter class. Removed 112 lines of duplicate code from 4 adapters, replaced with 43 lines of shared code. Net savings: 69 LOC. All 2349 tests pass."}
{"id":"dspy.rb-v0w","title":"[Refactor] Migrate GithubCliToolset","description":"**Phase**: Migration","acceptance_criteria":"- Create signatures for each operation\n- Create individual tool modules\n- Update any dependent code","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-14T19:00:17.606655+01:00","updated_at":"2026-01-14T19:00:17.606655+01:00","dependencies":[{"issue_id":"dspy.rb-v0w","depends_on_id":"dspy.rb-cdb","type":"blocks","created_at":"2026-01-14T19:01:26.51523+01:00","created_by":"Vicente Reig Rinc贸n de Arellano"}]}
{"id":"dspy.rb-v8a","title":"[TDD] Remove BaseSubscriber class","description":"## Context\nBaseSubscriber uses global subscription internally. Now that we've simplified the approach, we can remove it directly.\n\n## TDD Steps\n\n### 1. RED: Identify all BaseSubscriber usages\n```bash\ngrep -r 'BaseSubscriber' --include='*.rb'\ngrep -r '\u003c DSPy::Events::BaseSubscriber' --include='*.rb'\n```\n\nExpected usages:\n- spec/unit/module_event_integration_spec.rb (example classes in tests)\n- lib/dspy/events/subscribers.rb (the class itself)\n\n### 2. GREEN: Remove/refactor each usage\n\n**a) Refactor spec examples to use direct subscription:**\n```ruby\n# Before\nclass ModulePerformanceTracker \u003c DSPy::Events::BaseSubscriber\n  def subscribe\n    add_subscription('*.complete') { |e, a| ... }\n  end\nend\n\n# After - use DSPy::Module.subscribe pattern\nclass ModulePerformanceTracker \u003c DSPy::Module\n  subscribe '*.complete', :track_completion\n  \n  def track_completion(event_name, attrs)\n    # ...\n  end\nend\n```\n\n**b) Delete the BaseSubscriber class:**\n- Delete `lib/dspy/events/subscribers.rb`\n- Remove require from `lib/dspy.rb:224`\n\n### 3. REFACTOR: Run full test suite\n\n## Files to Delete\n- lib/dspy/events/subscribers.rb\n\n## Files to Edit\n- lib/dspy.rb (remove require)\n- spec/unit/module_event_integration_spec.rb (refactor example classes)\n\n## Acceptance Criteria\n- [ ] BaseSubscriber class removed\n- [ ] All specs refactored to use Module.subscribe\n- [ ] All tests pass\n- [ ] ~45 LOC removed","status":"open","priority":2,"issue_type":"task","owner":"hey@vicente.services","created_at":"2026-01-26T15:19:44.314209+01:00","created_by":"Vicente Reig Rinc贸n de Arellano","updated_at":"2026-01-26T15:33:33.962639+01:00","dependencies":[{"issue_id":"dspy.rb-v8a","depends_on_id":"dspy.rb-eh4","type":"blocks","created_at":"2026-01-26T15:20:03.290572+01:00","created_by":"Vicente Reig Rinc贸n de Arellano"}]}
{"id":"dspy.rb-vfe","title":"Simplify Event API: Module-Only Subscriptions","description":"Remove global event subscription API from public documentation and make DSPy::Module.subscribe the only DOCUMENTED entry point for event subscriptions.\n\n## Goal\nA simpler, more opinionated event API where:\n- Module DSL is the ONLY **documented** public subscription API\n- DSPy.events.subscribe remains available but **undocumented** (for internal use, Langfuse, power users)\n- Better encapsulation: users are guided toward module-scoped subscriptions\n\n## Current State\n- 4 subscription mechanisms: DSPy.events.subscribe, Module.subscribe, BaseSubscriber, SubscriberMixin\n- Global subscription used in tests, examples, Langfuse integration\n- SubscriberMixin is dead code (unused)\n- BaseSubscriber adds no value over direct subscription\n\n## Target State\n- Single **documented** API: DSPy::Module.subscribe\n- DSPy.events remains accessible but undocumented (internal API)\n- Langfuse integration unchanged (uses internal API)\n- Tests use internal API directly (no TestEventObserver class needed)\n- SubscriberMixin and BaseSubscriber removed\n\n## Breaking Changes\n- BaseSubscriber removed (users must use Module.subscribe or internal API)\n- SubscriberMixin removed (dead code, no impact)\n- Documentation only shows Module.subscribe pattern\n\n## Non-Breaking\n- DSPy.events.subscribe still works (just undocumented)\n- Langfuse integration unchanged\n- Existing code using DSPy.events.subscribe continues to work\n\n## Success Criteria\n- [ ] Only DSPy::Module.subscribe is documented\n- [ ] DSPy.events.subscribe still works (undocumented)\n- [ ] Langfuse integration unchanged\n- [ ] All tests pass\n- [ ] ~125 LOC reduction (SubscriberMixin + BaseSubscriber)","status":"open","priority":1,"issue_type":"epic","owner":"hey@vicente.services","created_at":"2026-01-26T15:18:35.062236+01:00","created_by":"Vicente Reig Rinc贸n de Arellano","updated_at":"2026-01-26T15:32:28.355235+01:00"}
{"id":"dspy.rb-wbn","title":"[TDD] Refactor Langfuse ScoresExporter to module-based","description":"## Context\nScoresExporter currently uses DSPy.events.subscribe directly. Refactor to a module mixin pattern.\n\n## TDD Steps\n\n### 1. RED: Write test for new Langfuse module pattern\n```ruby\nRSpec.describe 'Langfuse Module Integration' do\n  it 'exports scores when included in user module' do\n    class MyApp \u003c DSPy::Module\n      include DSPy::O11y::Langfuse::ScoreSubscriptions\n      \n      def forward(question:)\n        DSPy.score('accuracy', 0.95, trace_id: 'test-123')\n      end\n    end\n    \n    expect(langfuse_client).to receive(:score).with(hash_including(value: 0.95))\n    MyApp.new.call(question: 'test')\n  end\nend\n```\n\n### 2. GREEN: Implement module mixin\n```ruby\n# lib/dspy/o11y/langfuse/score_subscriptions.rb\nmodule DSPy\n  module O11y\n    module Langfuse\n      module ScoreSubscriptions\n        def self.included(base)\n          base.subscribe 'score.create', :_langfuse_export_score\n        end\n        \n        def _langfuse_export_score(event_name, attrs)\n          return unless DSPy::O11y::Langfuse.configured?\n          DSPy::O11y::Langfuse.client.score(\n            trace_id: attrs[:trace_id],\n            name: attrs[:score_name],\n            value: attrs[:score_value]\n          )\n        end\n      end\n    end\n  end\nend\n```\n\n### 3. REFACTOR: Update ScoresExporter class\n- Remove direct DSPy.events.subscribe usage\n- Delegate to the mixin or deprecate the class entirely\n\n## Files to Create\n- lib/dspy/o11y/langfuse/score_subscriptions.rb\n\n## Files to Edit\n- lib/dspy/o11y/langfuse/scores_exporter.rb\n\n## Acceptance Criteria\n- [ ] Users can `include DSPy::O11y::Langfuse::ScoreSubscriptions` in their modules\n- [ ] Score events automatically export to Langfuse\n- [ ] No direct DSPy.events.subscribe usage\n- [ ] Integration tests pass","status":"closed","priority":2,"issue_type":"task","owner":"hey@vicente.services","created_at":"2026-01-26T15:19:44.588841+01:00","created_by":"Vicente Reig Rinc贸n de Arellano","updated_at":"2026-01-26T15:33:20.418133+01:00","closed_at":"2026-01-26T15:33:20.418133+01:00","close_reason":"No longer needed as separate task. Langfuse update is now part of dspy.rb-04f (Make EventRegistry internal). ScoresExporter will use DSPy.send(:event_registry).subscribe().","dependencies":[{"issue_id":"dspy.rb-wbn","depends_on_id":"dspy.rb-04f","type":"blocks","created_at":"2026-01-26T15:20:03.544016+01:00","created_by":"Vicente Reig Rinc贸n de Arellano"}]}
{"id":"dspy.rb-yk4","title":"Replace bare rescue =\u003e e with rescue StandardError","description":"30+ instances of bare 'rescue =\u003e e' which catches SystemExit and SignalException. Locations: lib/dspy/lm/usage.rb:102,136,153,170, lib/dspy/evals.rb:390,429,455,487. Fix: change to 'rescue StandardError =\u003e e'.","status":"closed","priority":3,"issue_type":"task","owner":"hey@vicente.services","created_at":"2026-01-24T20:00:55.572953+01:00","created_by":"Vicente Reig Rinc贸n de Arellano","updated_at":"2026-01-24T20:30:12.047098+01:00","closed_at":"2026-01-24T20:30:12.047098+01:00","close_reason":"Replaced 54 bare 'rescue =\u003e e' with 'rescue StandardError =\u003e e' across 25 files. Prevents accidental catching of SystemExit and SignalException."}
{"id":"dspy.rb-z0m","title":"[Refactor] Migrate TextProcessingToolset","description":"**Phase**: Migration","acceptance_criteria":"- Evaluate: keep as toolset, inline, or split?\n- Migrate or deprecate","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-14T19:00:17.606324+01:00","updated_at":"2026-01-14T19:00:17.606324+01:00","dependencies":[{"issue_id":"dspy.rb-z0m","depends_on_id":"dspy.rb-cdb","type":"blocks","created_at":"2026-01-14T19:01:26.474766+01:00","created_by":"Vicente Reig Rinc贸n de Arellano"}]}
{"id":"dspy.rb-zjl","title":"Remove dead code in ReAct and CodeAct","description":"~115 lines of dead code: ThoughtBase/ReActObservationBase (re_act.rb:37-69, never instantiated), validate_output_schema! (re_act.rb:858-884, code_act.rb:430-456, Sorbet handles this), string_compatible_type? alias (re_act.rb:783-784).","status":"closed","priority":3,"issue_type":"task","owner":"hey@vicente.services","created_at":"2026-01-24T20:00:55.69627+01:00","created_by":"Vicente Reig Rinc贸n de Arellano","updated_at":"2026-01-24T20:11:37.811581+01:00","closed_at":"2026-01-24T20:11:37.811581+01:00","close_reason":"Removed 91 lines of dead code: ThoughtBase, ReActObservationBase classes, string_compatible_type? alias, validate_output_schema! methods from both ReAct and CodeAct. All 2349 tests pass."}
